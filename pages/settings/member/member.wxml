<!--pages/member/member.wxml-->
<view class="container">
  <!-- 主内容区 -->
  <view class="main-content">
    <!-- 成员列表 -->
    <view class="members-container">
      <view class="members-list" wx:if="{{members.length > 0}}">
        <view class="member-item {{selectedMemberId === item.memberid ? 'selected' : ''}}" wx:for="{{members}}" wx:key="memberid" bindtap="selectMember" data-id="{{item.memberid}}">
          <view class="member-info">
            <text class="member-name">{{item.name}}</text>
            <text class="member-detail">{{item.gender === 1 ? '男' : item.gender === 2 ? '女' : item.gender}} | {{item.formattedBirthday}}<text wx:if="{{item.age !== ''}}"> ({{item.age}}岁)</text></text>
          </view>
          <view class="member-selected-icon" wx:if="{{selectedMemberId === item.memberid}}">
            <text class="selected-icon">✓</text>
          </view>
        </view>
      </view>
      
      <!-- 空状态 -->
      <view class="empty-state" wx:if="{{members.length === 0}}">
        <view class="empty-content">
          <image class="empty-illustration" src="/images/empty-members.png" mode="aspectFit"></image>
          <text class="empty-text">还没有添加家庭成员</text>
        </view>
      </view>
    </view>
  </view>
  
  <!-- 悬浮按钮 -->
  <view class="fab-btn" bindtap="showAddModal">
    <text class="fab-icon">+</text>
  </view>
  
  <!-- 新增成员表单弹窗 -->
  <view class="modal" wx:if="{{showModal}}">
    <view class="modal-content">
      <scroll-view class="modal-form-wrapper" scroll-y>
        <form class="modal-form" bindsubmit="addMember">
          <view class="modal-header">
            <text class="modal-title">新增成员</text>
            <button class="close-btn" bindtap="hideAddModal">✕</button>
          </view>
          
          <!-- 基本信息组 -->
          <view class="form-group">
            <view class="form-item">
              <text class="label">姓名 *</text>
              <input class="input" name="name" value="{{name}}" bindinput="onNameInput" placeholder="请输入成员姓名" />
            </view>

            <view class="form-item">
              <text class="label">性别 *</text>
              <picker mode="selector" range="{{genderOptions}}" value="{{genderIndex}}" bindchange="onGenderChange">
                <view class="picker">
                  {{genderOptions[genderIndex]}}
                </view>
              </picker>
            </view>

            <view class="form-item">
              <text class="label">生日 *</text>
              <picker mode="date" value="{{birthday}}" bindchange="bindDateChange">
                <view class="picker">
                  {{birthday ? birthday : '请选择生日'}}
                </view>
              </picker>
            </view>
          </view>

          <button class="submit-btn" form-type="submit">确定</button>
        </form>
      </scroll-view>
    </view>
  </view>
</view>
