<view class="container">
  <!-- é¡¶éƒ¨å¯¼èˆªåŒº -->
  <view class="top-nav">
    <view class="nav-header">
      <view class="back-btn" bindtap="goBack">
        <text class="icon">â†</text>
      </view>
      <text class="page-title">è¡£æ©±åˆ—è¡¨é¡µ</text>
      <view class="search-btn" bindtap="showSearch">
        <text class="icon">ğŸ”</text>
      </view>
    </view>
    
    <!-- åˆ†ç±»æ ‡ç­¾ -->
    <scroll-view class="category-tabs" scroll-x="true">
      <view class="tab-item {{currentCategory === 'all' ? 'active' : ''}}" data-category="all" bindtap="switchCategory">
        <text>æ€»è§ˆ</text>
      </view>
      <view class="tab-item {{currentCategory === 'ä¸Šè¡£' ? 'active' : ''}}" data-category="ä¸Šè¡£" bindtap="switchCategory">
        <text>ä¸Šè¡£</text>
      </view>
      <view class="tab-item {{currentCategory === 'è£¤è£…' ? 'active' : ''}}" data-category="è£¤è£…" bindtap="switchCategory">
        <text>è£¤è£…</text>
      </view>
      <view class="tab-item {{currentCategory === 'å¤–å¥—' ? 'active' : ''}}" data-category="å¤–å¥—" bindtap="switchCategory">
        <text>å¤–å¥—</text>
      </view>
      <view class="tab-item {{currentCategory === 'é‹å±¥' ? 'active' : ''}}" data-category="é‹å±¥" bindtap="switchCategory">
        <text>é‹å±¥</text>
      </view>
    </scroll-view>
    
    <!-- é¢œè‰²ç­›é€‰ -->
    <view class="color-filter">
      <text class="filter-label">é¢œè‰²ï¼š</text>
      <view class="color-dot {{selectedColor === '' ? 'active' : ''}}" style="background-color: #ccc;" data-color="" bindtap="selectColor"></view>
      <view class="color-dot {{selectedColor === 'green' ? 'active' : ''}}" style="background-color: #4CAF50;" data-color="green" bindtap="selectColor"></view>
      <view class="color-dot {{selectedColor === 'yellow' ? 'active' : ''}}" style="background-color: #FFEB3B;" data-color="yellow" bindtap="selectColor"></view>
      <view class="color-dot {{selectedColor === 'brown' ? 'active' : ''}}" style="background-color: #795548;" data-color="brown" bindtap="selectColor"></view>
      <view class="color-dot {{selectedColor === 'gray' ? 'active' : ''}}" style="background-color: #9E9E9E;" data-color="gray" bindtap="selectColor"></view>
    </view>
    
    <!-- å­£èŠ‚ç­›é€‰ -->
    <view class="season-filter">
      <text class="filter-label">å­£èŠ‚ï¼š</text>
      <view class="season-dot {{selectedSeason === '' ? 'active' : ''}}" data-season="" bindtap="selectSeason">å…¨éƒ¨</view>
      <view class="season-dot {{selectedSeason === 'spring' ? 'active' : ''}}" data-season="spring" bindtap="selectSeason">æ˜¥</view>
      <view class="season-dot {{selectedSeason === 'summer' ? 'active' : ''}}" data-season="summer" bindtap="selectSeason">å¤</view>
      <view class="season-dot {{selectedSeason === 'autumn' ? 'active' : ''}}" data-season="autumn" bindtap="selectSeason">ç§‹</view>
      <view class="season-dot {{selectedSeason === 'winter' ? 'active' : ''}}" data-season="winter" bindtap="selectSeason">å†¬</view>
    </view>
  </view>
  
  <!-- æ•°æ®æ¦‚è§ˆåŒº -->
  <view class="data-overview">
    <view class="total-count">
      <text class="count-number">{{totalCount}}</text>
      <text class="count-label">ä»¶è¡£ç‰©</text>
    </view>
    
    <view class="category-counts">
      <view class="count-item">
        <text class="count-name">ä¸Šè¡£</text>
        <text class="count-value">{{categoryCounts.shangyi || 0}}</text>
      </view>
      <view class="count-item">
        <text class="count-name">è£¤è£…</text>
        <text class="count-value">{{categoryCounts.kuzhuang || 0}}</text>
      </view>
      <view class="count-item">
        <text class="count-name">å¤–å¥—</text>
        <text class="count-value">{{categoryCounts.waitao || 0}}</text>
      </view>
      <view class="count-item">
        <text class="count-name">é‹å±¥</text>
        <text class="count-value">{{categoryCounts.xielv || 0}}</text>
      </view>
    </view>
    
    <view class="clean-btn" bindtap="cleanClothing">
      <text class="icon">ğŸ—‘</text>
    </view>
  </view>
  
  <!-- è¡£ç‰©å±•ç¤ºåŒº -->
  <view class="clothing-grid">
    <view class="clothing-card" wx:for="{{filteredClothingList}}" wx:key="id" bindtap="goToDetail" data-id="{{item.id}}">
      <view class="card-content">
        <view class="clothing-name">{{item.name}}</view>
        <view class="clothing-brand">{{item.brand || 'æ— å“ç‰Œ'}}</view>
        <view class="clothing-tags">
          <view class="tag color-tag" style="background-color: {{getColorByTag(item.color)}};">{{item.color}}</view>
          <view class="tag season-tag">{{getSeasonByTag(item.season)}}</view>
        </view>
        <view class="clothing-time">{{item.last_worn || 'åˆšåˆšæ·»åŠ '}}</view>
      </view>
    </view>
  </view>
  
  <!-- åº•éƒ¨å·¥å…·åŒº -->
  <view class="bottom-tools">
    <view class="floating-btn" bindtap="goToTodayOutfit">
      <text class="icon">âœ¨</text>
      <text class="btn-text">ä»Šæ—¥ç©¿æ­</text>
    </view>
  </view>
  
  <!-- æœç´¢å¼¹çª— -->
  <view class="search-modal" wx:if="{{showSearchModal}}">
    <view class="search-content">
      <view class="search-header">
        <text class="search-title">æœç´¢è¡£ç‰©</text>
        <view class="close-btn" bindtap="hideSearch">âœ•</view>
      </view>
      <view class="search-box">
        <input class="search-input" placeholder="æœç´¢è¡£ç‰©åç§°æˆ–å“ç‰Œ" value="{{searchKeyword}}" bindinput="onSearchInput" bindconfirm="onSearchConfirm" />
        <button class="search-button" bindtap="onSearch">æœç´¢</button>
      </view>
      <view class="search-results">
        <view class="result-item" wx:for="{{searchResults}}" wx:key="id" bindtap="goToDetail" data-id="{{item.id}}">
          <text>{{item.name}} - {{item.brand}}</text>
        </view>
      </view>
    </view>
  </view>
  
  <!-- æ–°å¢æœè£…è¡¨å•å¼¹çª— -->
  <view class="modal" wx:if="{{showModal}}">
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">æ–°å¢æœè£…</text>
        <button class="close-btn" bindtap="hideAddModal">âœ•</button>
      </view>
      <form class="add-form" bindsubmit="addClothing">
        <view class="form-item">
          <text class="label">åç§° *</text>
          <input class="input" name="name" value="{{name}}" bindinput="onNameInput" placeholder="è¯·è¾“å…¥è¡£ç‰©åç§°" required />
        </view>
        <view class="form-item">
          <text class="label">åˆ†ç±» *</text>
          <input class="input" name="category" value="{{category}}" bindinput="onCategoryInput" placeholder="è¯·è¾“å…¥è¡£ç‰©åˆ†ç±»" required />
        </view>
        <view class="form-item">
          <text class="label">é¢œè‰²</text>
          <input class="input" name="color" value="{{color}}" bindinput="onColorInput" placeholder="è¯·è¾“å…¥é¢œè‰²" />
        </view>
        <view class="form-item">
          <text class="label">å“ç‰Œ</text>
          <input class="input" name="brand" value="{{brand}}" bindinput="onBrandInput" placeholder="è¯·è¾“å…¥å“ç‰Œ" />
        </view>
        <view class="form-item">
          <text class="label">è´­ä¹°æ—¥æœŸ</text>
          <picker mode="date" value="{{purchaseDate}}" bindchange="bindDateChange">
            <view class="date-picker">
              <text wx:if="{{purchaseDate}}">{{purchaseDate}}</text>
              <text wx:else>è¯·é€‰æ‹©è´­ä¹°æ—¥æœŸ</text>
            </view>
          </picker>
        </view>
        <view class="form-item">
          <text class="label">ä»·æ ¼</text>
          <input class="input" name="price" value="{{price}}" bindinput="onPriceInput" type="digit" placeholder="è¯·è¾“å…¥ä»·æ ¼" />
        </view>
        <view class="form-item">
          <text class="label">å›¾ç‰‡</text>
          <view class="upload-area" bindtap="chooseAndUploadImage">
            <text wx:if="{{!imageUrl}}">ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡</text>
            <image wx:if="{{imageUrl}}" src="{{imageUrl}}" class="preview-image" />
          </view>
        </view>
        <button class="submit-btn" bindtap="handleSubmit">ç¡®å®š</button>
      </form>
    </view>
  </view>
</view>